<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Répétitions avec fins alternatives - MyRealBook </title>
        
        <meta name="robots" content="noindex,nofollow" />
        <meta name="generator" content="Publii Open-Source CMS for Static Site" />
        
        
        <link rel="alternate" type="application/atom+xml" href="https://myrealbook.vintherine.org/feed.xml" />
<link rel="alternate" type="application/json" href="https://myrealbook.vintherine.org/feed.json" />

        <meta property="og:title" content="Répétitions avec fins alternatives" /><meta property="og:site_name" content="MyRealBook" /><meta property="og:description" content="Avec Lilypond les répétitions avec fins alternatives sont indiquées ordinairement de la manière suivante :" /><meta property="og:url" content="https://myrealbook.vintherine.org/repetitions-avec-fins-alternatives.html" /><meta property="og:type" content="article" />
        <style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style>
        <link rel="stylesheet" href="https://myrealbook.vintherine.org/assets/css/style.css?v=489237eb5e2f09dd77c9332d52b3a5e5">       
        <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://myrealbook.vintherine.org/repetitions-avec-fins-alternatives.html"},"headline":"Répétitions avec fins alternatives","datePublished":"2021-08-30T13:25","dateModified":"2021-09-26T12:32","description":"Avec Lilypond les répétitions avec fins alternatives sont indiquées ordinairement de la manière suivante :","author":{"@type":"Person","name":"Vincent"},"publisher":{"@type":"Organization","name":"Vincent"}}</script>        
        
        <link type="application/atom+xml" rel="alternate" href="https://myrealbook.vintherine.org/feed.xml"/>
<link type="application/json" rel="alternate" href="https://myrealbook.vintherine.org/feed.json"/> 
    </head>
    <body>
        <header class="header" id="js-header">

   <a href="https://myrealbook.vintherine.org/" class="logo">
         MyRealBook
   </a>

      <nav class="navbar js-navbar">
         <button class="navbar__toggle js-toggle" aria-label="Menu">
            <span class="navbar__toggle-box">
               <span class="navbar__toggle-inner">Menu</span>
            </span>
         </button>
         <ul class="navbar__menu">
                  <li>
                  <a
                     href="https://myrealbook.vintherine.org/index.html"
                        target="_self"
         >
                     Blog
                  </a>
         
            </li>
                  <li>
                  <a
                     href="https://myrealbook.vintherine.org/scores/index.html"
                        target="_self"
         >
                     Partitions
                  </a>
         
            </li>
                  <li>
                  <a
                     href="https://myrealbook.vintherine.org/about.html"
                        target="_self"
         >
                     À propos
                  </a>
         
            </li>
                  <li>
                  <a
                     href="https://myrealbook.vintherine.org/https://myrealbook.vintherine.org/feed.json"
                        target="_self"
         >
                     Flux RSS
                  </a>
         
            </li>
         </ul>      </nav>

      <div class="search">
          <div class="search__overlay js-search-overlay">
            <form action="https://myrealbook.vintherine.org/search.html" class="search__form">
               <input
                  class="search__input js-search-input"
                  type="search"
                  name="q"
                  aria-label="Search input" 
                  placeholder="search..."
                  autofocus="autofocus"/>
               <button class="search__submit">Search</button>
            </form>
         </div>
         <button
            class="search__btn js-search-btn"
            aria-label="Search">
            <svg role="presentation" focusable="false" height="18" width="18">
               <use xlink:href="https://myrealbook.vintherine.org/assets/svg/svg-map.svg#search"/>
            </svg>
         </button>
      </div>

</header>
<main>
   <div class="wrapper">
         <article class="post">
            <header class="post__header">
               <h1 class="post__title">
                  Répétitions avec fins alternatives
               </h1>
                  <div class="post__meta">
                        <div class="post__author">By
                              <a href="https://myrealbook.vintherine.org/authors/vincent/" class="invert" rel="author" title="Vincent">Vincent</a>
                        </div>

                  </div>
            </header>

            <div class="post__inner">
               <div class="post__entry">
                  <p>Avec Lilypond les répétitions avec fins alternatives sont indiquées ordinairement de la manière suivante :</p>

<pre><code>\repeat volta x {</code><br><code> ... musique ...</code><br><code> }</code><br><code>\alternative {</code><br><code> { ... alternative 1 }</code><br><code> { ... alternative 2 }</code><br><code> { ... alternative x }</code><br><code> }</code></pre>
<p>Ce qui donnera par exemple quelque chose comme ceci :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/7/AlternatisesStandards.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/7/responsive/AlternatisesStandards-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/7/responsive/AlternatisesStandards-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/7/responsive/AlternatisesStandards-md.png 768w"  alt="" width="441" height="66"></figure>

<p>Il arrive toutefois que l'on soit amené à contrôler manuellement les indications de reprises. Prenons pour exemple le standart de Jazz <em><strong>Jeannine</strong></em> de Duke Pearson. C'est une pièce de la forme A1 A2 B A1. Imaginons que nous souhaitions indiquer la répétition sous la forme </p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/7/JeanineAlternatives.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/7/responsive/JeanineAlternatives-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/7/responsive/JeanineAlternatives-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/7/responsive/JeanineAlternatives-md.png 768w"  alt="" width="1288" height="197"></figure>
<p>avec barre de reprise en fin de B. Avec la formulation standard nous nous heurterions à la double difficulté suivante :</p>
<ul>
<li>l'ordre retenu par défaut serait [ 1 &amp; 2 ] [ 3     ]</li>
<li>il ne serait pas possible de rajouter une indication textuelle. </li>
</ul>
<p><strong>[EDIT] Sur la <a href="https://lists.gnu.org/mailman/listinfo/lilypond-user-fr">mailing list des utilisateurs francophone de Lilypond</a> j'ai reçu de Jean Abou Samra une solution beaucoup plus simple et élégante que celle que j’utilisais jusqu'à présent. C'est cette nouvelle solution que je décris ci-dessous, l'ancienne étant pour archive à la fin de ce post. </strong></p>
<p>Dans la version 2.22 il est possible de modifier le texte des alternatives avec la commande <code>\overrideProperty Score.VoltaBracket.text [\markup]</code>. <strong>Attention</strong> : dans les futures versions (c'est déjà vrai dans la version de développement 2.23) cette commande deviendra plus simplement <code>\once \override Score.VoltaBracket.text <strong>=</strong> [\markup]</code> (attention au signe =).</p>
<p>Voici un exemple minimaliste :</p>
<pre><code>\version "2.22.1"</code><br><br><code>voltaAdLib = \markup { 1. 2. 3… \italic \text "ad lib." }</code><br><code>voltaOnCue = \markup \small \with-color "red" \italic \text "On Cue"</code><br><br><code>\relative c'' {</code><br><code>  c4 c c c</code><br><code>  \repeat volta 2 {</code><br><code>    c4 c c c</code><br><code>  }</code><br><code>  \alternative {</code><br><code>    {</code><br><code>      \overrideProperty Score.VoltaBracket.text \voltaAdLib</code><br><code>      c4 c c c</code><br><code>    }</code><br><code>    {</code><br><code>      \overrideProperty Score.VoltaBracket.text \voltaOnCue</code><br><code>      c1</code><br><code>    }</code><br><code>  }</code><br><code>} </code></pre>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/7/OnCue.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/7/responsive/OnCue-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/7/responsive/OnCue-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/7/responsive/OnCue-md.png 768w"  alt="" width="823" height="157"></figure>
<p>Voici pour finir le code complet de <strong>Jeannine</strong> :  </p>
<pre>\version "2.22.1"<br><br>\paper {<br>  indent = 0\mm<br>  markup-system-spacing = #'((basic-distance . 20)<br>                             (minimum-distance . 8)<br>                             (padding . 1))<br>}<br><br>\header {<br>  title = Jeannine<br>  composer = "Duke Pearson"<br>  poet = "Med. Up Swing"<br>  tagline = ##f<br>}<br><br>theChords = \chordmode {<br>  \set chordChanges = ##t<br>  as1*4:m7 as:m7 fis1:m7<br>  b1:7 e:7+ a:7 bes:m7 es:9+ as1:7+ es:9+<br>  as:7+ es2:m7 as:7<br>  des1:7+ g2:m5-7 c:7 f1*2:7+ f1:m7 bes:7 bes:m7 es:7<br>}<br><br>voltaOne = \markup { 1 \text { &amp; } 3 \text \fontsize #4 \with-color #red \italic { " (fine)" }}<br><br><br>theNotes = \relative c'' {<br>  \set Score.markFormatter = #format-mark-box-alphabet<br>  \clef "treble" \key as \major \time 4/4 \mark #1<br>  \repeat volta 2 {<br>    r8 es4-. r8 es4-. r | r8 es4-. r8 es4-. f-.<br>    ges--( f8 es ~ es2 ~ | es1) \break<br>    r8 es4-. r8 es4-. r | r8 es4-. r8 es4-. f-.<br>    ges-- f8 es ~ es2 ~ | es r8 c des as' ~ \break<br>    as4. e8-. r des4-. a8 | as'!4-- g8 ges-&gt; ~ ges as ges b-&gt; ~<br>    b2 ~ b8 bes b ges-&gt; ~ | ges2. e8 es~ \break |<br>    es4. es8 r2 | r8 bes( \times 2/3 { c des es } ges4 e8 es) ~ |<br>  }<br>  \alternative {<br>    {<br>      \overrideProperty Score.VoltaBracket.text \voltaOne<br>      es1 ~ | es1<br>    }<br>    {<br>      es2 \repeatTie \times 2/3 { es4 c es } f2 es<br>      \bar "||" \break \mark #2<br>      as,2 ~ as8( bes \times 2/3 { c des es } |<br>      f4-.) r8 g-&gt;~g( f g a-&gt;) ~<br>      a1 | r8 e4.-&gt; \times 2/3 { f4 g a } \break<br>      as?2 \times 2/3 { as4 g as } | bes2 f |<br>      bes1 ~ | bes2. r4 \bar ":|."<br>    }<br>  }<br>}<br><br>\score {<br>  &lt;&lt;<br>    \new ChordNames \theChords<br>    \new Staff \theNotes<br>  &gt;&gt;<br>}</pre>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/7/jeannine.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/7/responsive/jeannine-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/7/responsive/jeannine-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/7/responsive/jeannine-md.png 768w"  alt="" width="1585" height="1090"></figure>
<p>Voici donc comment je procédais avant le message de Jean : plutôt que d'utiliser la commande normale \repeat volta 2 j'utilisais des instructions explicites qui agissent sur la propriété Score.repeatCommands : </p>
<ul>
<li><code>\set Score.repeatCommands = #'(start-repeat)</code> imprime la barre de début de répétition (équivalent à \bar ".|:" ou à \bar "[|:")</li>
<li><code>\set Score.repeatCommands = #'(end-repeat)</code> imprime la barre de fin de répétition (équivalent à \bar ";|." ou à \bar ":|]")</li>
<li><code>\set Score.repeatCommands = #'((volta #f))</code> interrompt le crochet d'alternative. Si Lilypond ne trouve pas de fin d'alternative (volta #f ou accolade } de l'instruction ordinaire d'alternative) le crochet ne sera pas imprimé.</li>
<li><code>\set Score.repeatCommands = #'((volta "1"))</code> indique le numéro de l'alternative. il peut être multiple, par ex. #'((volta "1, 2")) ou #'((volta "5, 34")). </li>
<li>Il est possible de mixer plusieurs instructions en une seule commande. Par exemple  <code>\set Score.repeatCommands = #'((volta #f) (volta "2") end-repeat)</code> termine le crochet, ouvre le crochet de l'alternative suivante et imprime la barre de reprise.</li>
<li>Pour intégrer des indications textuelles il faut préalablement définir celles-ci dans un markup puis les intégrer par la comande <code>\set Score.repeatCommands = #(list(list 'volta le_markup))</code>. Par exemple :</li>
</ul>
<pre><code>\version "2.22.1"</code><br><br><code>voltaAdLib = \markup { 1. 2. 3... \text \italic { ad lib. } }</code><br><code>voltaOnCue= \markup \small \with-color #(x11-color 'red) { \text \italic { On Cue } }</code><br><br><code>\relative c'' {</code><br><code> c4 c c c</code><br><code> \set Score.repeatCommands = #'(start-repeat)</code><br><code> c4 c c c </code><br><code> \set Score.repeatCommands = #(list(list 'volta voltaAdLib))</code><br><code> c4 c c c</code><br><code> \set Score.repeatCommands = #(list '(volta #f) (list 'volta voltaOnCue) 'end-repeat)</code><br><code> c1</code><br><code> \set Score.repeatCommands = #'((volta #f))</code><br><code>}</code></pre>
<p> </p>
               </div>
                  <footer>


                        <div class="post__tags-share">

                        </div>


                  </footer>
            </div>
         </article>



   </div>

</main>
<footer class="footer">
      <div class="footer__copyright">
         <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><br />Tous les textes, images et codes sources Lilypond contenus dans ce site sont mis à disposition selon les termes de la <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licence Creative Commons Attribution -  Partage dans les Mêmes Conditions 4.0 International</a>.
      </div>
</footer>
<script>
   window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };
</script>
<script defer src="https://myrealbook.vintherine.org/assets/js/scripts.min.js?v=8b3e67b51e8c7a7d51b33f4a94ae4287"></script>
   <script>        
      var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }
   </script>


</body>
</html>
