<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>MyRealBook</title>
    <link href="https://myrealbook.vintherine.org/feed.xml" rel="self" />
    <link href="https://myrealbook.vintherine.org" />
    <updated>2022-03-25T10:52:54+01:00</updated>
    <author>
        <name>Vincent</name>
    </author>
    <id>https://myrealbook.vintherine.org</id>

    <entry>
        <title>Numérotation des pages</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/numerotation-des-pages.html"/>
        <id>https://myrealbook.vintherine.org/numerotation-des-pages.html</id>

        <updated>2022-03-15T14:25:33+01:00</updated>
            <summary>
                <![CDATA[
                    <p>Contrairement à l'édition papier le nombre de page d'une édition numérique (lecture sur tablette par ex.) n'est pas immédiatement visible. La manière la plus simple me paraît être d'utiliser la numérotation des pages sous la forme x/n où x est le numéro de la page en cours et n le nombre total de pages. Cela n'est pas prévu par défaut par Lilypond mais peut se contourner de la manière suivante.</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Contrairement à l'édition papier le nombre de page d'une édition numérique (lecture sur tablette par ex.) n'est pas immédiatement visible. La manière la plus simple me paraît être d'utiliser la numérotation des pages sous la forme x/n où x est le numéro de la page en cours et n le nombre total de pages. Cela n'est pas prévu par défaut par Lilypond mais peut se contourner de la manière suivante.</p>

<p><strong>Tout d'abord</strong> mettre un label à la toute fin de la partition (<code>\label #'theLastPage</code> par exemple). C'est le seul moyen de connaitre le nombre total de pages (<code>\page-ref #'theLastPage</code>).</p>
<p><strong>Ensuite</strong> ajouter les lignes suivantes dans le bloc paper</p>
<pre><code> \paper {</code><br><code> oddHeaderMarkup = \markup {</code><br><code>    \on-the-fly \print-page-number-check-first {</code><br><code>      \fill-line { \null \concat { \fromproperty #'page:page-number-string "/" \page-ref #'theLastPage "0" "?"} }</code><br><code>  } }</code><br><code>  evenHeaderMarkup = \markup {</code><br><code>    \on-the-fly \print-page-number-check-first {</code><br><code>      \fill-line { \concat { \fromproperty #'page:page-number-string "/" \page-ref #'theLastPage "0" "?"} \null }</code><br><code>  } } }</code></pre>
<p>la condition <code>\on-the-fly \print-page-number-check-first</code> vérifie que impression du numéro de page doit se faire y compris pour la première page, ce qui n'est  pas l'option par défaut. <strong>Donc</strong> dans les books ou bookparts concernés rajouter</p>
<pre>  <code>\paper {</code><br><code>   print-first-page-number = ##t</code><br><code>  }</code></pre>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/29//BeginTheBeguine.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/29//responsive/BeginTheBeguine-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/29//responsive/BeginTheBeguine-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/29//responsive/BeginTheBeguine-md.png 768w"  alt="" width="543" height="209"></figure>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Grille harmonique</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/grille-harmonique.html"/>
        <id>https://myrealbook.vintherine.org/grille-harmonique.html</id>

        <updated>2022-03-25T10:52:54+01:00</updated>
            <summary>
                <![CDATA[
                    <p>La grille harmonique (voir sur <a title="https://fr.wikipedia.org/wiki/Grille_harmonique">Wikipédia</a>) est paraît-il une spécificité du jazz français. Elle m'est souvent réclamée par la section rythmique qui la trouve plus facile à lire qu'une ligne d'accords au dessus d'une portée. </p>
<p>Voici les divisions que j'utilise (mesures à 4 temps, les chiffres dans les case indiquant l'ordre de lecture)</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/28//ordreAccords-2.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/28//responsive/ordreAccords-2-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/28//responsive/ordreAccords-2-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/28//responsive/ordreAccords-2-md.png 768w"  alt="" width="792" height="202"></figure>
<p>Jusqu'à ce jour le code Lilypond utilisé pour produire ce genre de grille tenait franchement de la bidouille et il fallait souvent mettre les mains dans le cambouis pour produire un résultat à peu près présentable. Je me suis donc décidé à re-porter ce problème sur la liste francophone des utilisateurs de Lilypond. <a title="https://lists.gnu.org/archive/html/lilypond-user-fr/2022-03/msg00014.html">Le fil de la discussion</a>.</p>
<p>Avec l'aide décisive de Jean, notre développeur en chef, je dispose enfin d'un code propre et lisible.</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>La grille harmonique (voir sur <a title="https://fr.wikipedia.org/wiki/Grille_harmonique">Wikipédia</a>) est paraît-il une spécificité du jazz français. Elle m'est souvent réclamée par la section rythmique qui la trouve plus facile à lire qu'une ligne d'accords au dessus d'une portée. </p>
<p>Voici les divisions que j'utilise (mesures à 4 temps, les chiffres dans les case indiquant l'ordre de lecture)</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/28//ordreAccords-2.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/28//responsive/ordreAccords-2-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/28//responsive/ordreAccords-2-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/28//responsive/ordreAccords-2-md.png 768w"  alt="" width="792" height="202"></figure>
<p>Jusqu'à ce jour le code Lilypond utilisé pour produire ce genre de grille tenait franchement de la bidouille et il fallait souvent mettre les mains dans le cambouis pour produire un résultat à peu près présentable. Je me suis donc décidé à re-porter ce problème sur la liste francophone des utilisateurs de Lilypond. <a title="https://lists.gnu.org/archive/html/lilypond-user-fr/2022-03/msg00014.html">Le fil de la discussion</a>.</p>
<p>Avec l'aide décisive de Jean, notre développeur en chef, je dispose enfin d'un code propre et lisible.</p>

<p>Voici un exemple minimal avec reprise alternative :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/28//DemoChordGrid.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/28//responsive/DemoChordGrid-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/28//responsive/DemoChordGrid-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/28//responsive/DemoChordGrid-md.png 768w"  alt="" width="783" height="285"></figure>
<p>Tout d'abord il est nécessaire d'enregistrer et d'inclure la fonction codée par Jean, modifiée par mes soins  pour augmenter la taille des cases, téléchargeable <a href="https://acloud.zaclys.com/index.php/s/SJeiZD7oxbn8G62">depuis mon cloud</a>. </p>
<p>Pour l'inclure reportez vous <a href="https://lilypond.org/doc/v2.22/Documentation/notation/including-lilypond-files.html">à cette page</a> ou, si vous utilisez Frescobaldi, sauvegardez le dans un répertoire que vous aurez préalablement désigné comme répertoire d'inclusion. Voir <a href="https://frescobaldi.org/uguide.fr.html#help_preferences_lilypond">le manuel en ligne</a>. </p>
<p>La grille est décrite à la manière d'un <a href="https://lilypond.org/doc/v2.22/Documentation/notation/chord-mode">chordmode</a> en intégrant les sauts de ligne (<code>\break</code>) : même nombre de cases par ligne, en principe 4.  Jean s'est bien proposé de coder un saut automatique mais d'une part cela ne fonctionne pas encore et d'autre part cela n'est pas bien pénible de saisir un <code>\break</code> manuellement </p>
<p>Pour les reprises alternatives, comme vous pouvez le voir ci-dessus, l'idée est de faire une ligne représentant la 2ème alternative en n'affichant que la ou les mesure(s) différenciée(s). Pour ne pas faire de cases vides on remplace les autres par des <code>s1 </code>(silences invisibles) et des <code>\bar ""</code> (barres invisibles) entourés d'un <code>\stopStaff </code>et d'un <code>\startStaff</code></p>
<p>Voici le code de l'exemple ci-dessus</p>
<pre><code>\version "2.22.2"</code><br><code>\include "jazzchords.ily"    % Si vous utilisez Lilyjazz</code><br><code>\include "lilyjazz.ily"      % Si vous utilisez Lilyjazz</code><br><code>\include "chord-grid-JAS.ly" % la fonction codée par Jean Abou-Samra</code><br><br><code>#(set-global-staff-size 18)</code><br><br><code>\paper {</code><br><code>  #(set-paper-size "a4")</code><br><code>  indent = 0</code><br><code>}</code><br><br><code>\layout {</code><br><code>  \context {</code><br><code>    \Score</code><br><code>    startRepeatType = #"[|:"</code><br><code>    endRepeatType = #":|]"</code><br><code>    doubleRepeatType = #":|][|:"</code><br><code>   }</code><br><code>}</code><br><br><code>mus = \chordmode {  <br>% la grille proprement dite, 1 ligne par case</code><br><code>  g1:m7+</code><br><code>  a2:m5-7 d:5+7</code><br><code>  a4:m5-7 d2.:5+7</code><br><code>  a2.:m5-7 d4:5+7</code><br><code>  \break</code><br><code>  a4:m5-7 d:5+7 g2:m7</code><br><code>  g2:m7+ a4:m5-7 d:5+7</code><br><code>  g4:m7+ e:m5-7 a:m5-7 d:5+7</code><br><code>  \set Score.repeatCommands = #'((volta "1.") )</code><br><code>  a2:m5-7 d:5+7</code><br><code>  \set Score.repeatCommands = #'((volta #f) end-repeat)</code><br><code>  \break</code><br><code>  \stopStaff s1 \bar "" s \bar "" s \startStaff</code><br><code>  \set Score.repeatCommands = #'((volta "2.") )</code><br><code>  g1:m6</code><br><code>  \set Score.repeatCommands = #'((volta #f))</code><br><code>  \bar ".."</code><br><code>}</code><br><br><code>\score {</code><br><code> \gridLayout  % layout enregistré dans le fichier inclus "chord-grid-JAS.ly"</code><br><code> \new ChordGrid \mus</code><br><code>}</code></pre>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Reprises alternatives avec MuseScore</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/reprises-alternatives-avec-musescore.html"/>
        <id>https://myrealbook.vintherine.org/reprises-alternatives-avec-musescore.html</id>

        <updated>2022-01-26T22:00:01+01:00</updated>
            <summary>
                <![CDATA[
                    <p>Il n'y a pas que Lilypond dans la vie, il y a aussi <a href="https://musescore.org/fr">MuseScore</a>. S'il se présente également comme éditeur de partitions (wysiwyg celui-ci) je l'utilise pour ses capacité à jouer  les partitions avec son synthétiseur intégré : c'est avec cet outil que je travaille à mes compositions, arrangements, relevées ou bande d'accompagnement.  </p>
<p>S'il est somme toute très simple à prendre en main il y a quelques fonctionnalités pas vraiment intuitives. C'est le cas des reprises lorsqu'une alternative  doit être jouée plus de 2 fois. Par exemple :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/27//2022-01-26-1643230195_3840x1080_scrot.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/27//responsive/2022-01-26-1643230195_3840x1080_scrot-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/27//responsive/2022-01-26-1643230195_3840x1080_scrot-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/27//responsive/2022-01-26-1643230195_3840x1080_scrot-md.png 768w"  alt="" width="583" height="465"></figure>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Il n'y a pas que Lilypond dans la vie, il y a aussi <a href="https://musescore.org/fr">MuseScore</a>. S'il se présente également comme éditeur de partitions (wysiwyg celui-ci) je l'utilise pour ses capacité à jouer  les partitions avec son synthétiseur intégré : c'est avec cet outil que je travaille à mes compositions, arrangements, relevées ou bande d'accompagnement.  </p>
<p>S'il est somme toute très simple à prendre en main il y a quelques fonctionnalités pas vraiment intuitives. C'est le cas des reprises lorsqu'une alternative  doit être jouée plus de 2 fois. Par exemple :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/27//2022-01-26-1643230195_3840x1080_scrot.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/27//responsive/2022-01-26-1643230195_3840x1080_scrot-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/27//responsive/2022-01-26-1643230195_3840x1080_scrot-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/27//responsive/2022-01-26-1643230195_3840x1080_scrot-md.png 768w"  alt="" width="583" height="465"></figure>

<p>Il faut :</p>
<ul>
<li>Sélectionner la ligne alternative précédant la barre de reprise (1.2.3)</li>
<li>Afficher l'inspecteur (touche de fonction F8 ou menu affichage)</li>
<li>Éditer la zone texte de début</li>
<li>Remplir tout en bas la liste des reprises qui doivent être jouées</li>
<li>Sélectionner la mesure précédant la barre de reprise</li>
<li>Par le menu contextuel (bouton droit) éditer les propriétés de la mesure</li>
<li>Dans nombres de lectures indiquer le nombre correspondant à la liste des reprises +1</li>
</ul>
<p>Un bon dessin vaut mieux qu'un long discours ?</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/27//RepriseMS.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/27//responsive/RepriseMS-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/27//responsive/RepriseMS-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/27//responsive/RepriseMS-md.png 768w"  alt="" width="1092" height="658"></figure>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Le principe de la moindre altération</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/le-principe-de-la-moindre-alteration.html"/>
        <id>https://myrealbook.vintherine.org/le-principe-de-la-moindre-alteration.html</id>

        <updated>2022-01-23T15:45:16+01:00</updated>
            <summary>
                <![CDATA[
                    <p>Une particularité de Lilypond est de pouvoir stocker des fragments musicaux dans des variables et de pouvoir les réutiliser où bon nous semble et comme bon nous semble. En les transposant notamment. Mais par défaut le résultat n'est pas toujours lisible !</p>
<p>Pour les notes il suffit  souvent d'un peu d'astuce. Par exemple si l'on veut transposer un La♯ d'une tierce mineure en dessous (transposer une partie de violon pour un saxophone alto) cela nous donnera un Fa<span class="wdg-select-all-ok">𝄪 mais si on le transpose d'une seconde augmentée (1 ton ½ également) cela nous donnera un Sol. Voici ce que donne ce principe appliqué à la gamme de Si majeur (code ci-dessous)</span></p>
<figure class="post__image" ><img loading="lazy" src="https://myrealbook.vintherine.org/media/posts/26/document-3.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/26/responsive/document-3-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/26/responsive/document-3-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/26/responsive/document-3-md.png 768w"  alt="" width="570" height="300">
<figcaption >Transposition pour saxophones</figcaption>
</figure>
<p> </p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Une particularité de Lilypond est de pouvoir stocker des fragments musicaux dans des variables et de pouvoir les réutiliser où bon nous semble et comme bon nous semble. En les transposant notamment. Mais par défaut le résultat n'est pas toujours lisible !</p>
<p>Pour les notes il suffit  souvent d'un peu d'astuce. Par exemple si l'on veut transposer un La♯ d'une tierce mineure en dessous (transposer une partie de violon pour un saxophone alto) cela nous donnera un Fa<span class="wdg-select-all-ok">𝄪 mais si on le transpose d'une seconde augmentée (1 ton ½ également) cela nous donnera un Sol. Voici ce que donne ce principe appliqué à la gamme de Si majeur (code ci-dessous)</span></p>
<figure class="post__image" ><img loading="lazy" src="https://myrealbook.vintherine.org/media/posts/26/document-3.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/26/responsive/document-3-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/26/responsive/document-3-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/26/responsive/document-3-md.png 768w"  alt="" width="570" height="300">
<figcaption >Transposition pour saxophones</figcaption>
</figure>
<p> </p>

<pre>\version "2.22.1"<br><br>theNotes = \relative c' { <br>  \key b \major<br>  b4 cis dis e fis gis ais b~ | 1 }<br><br>\layout {<br>  indent = 5\cm<br>}<br><br>\score {<br>  &lt;&lt;<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { "Instruments"<br>                         \line { "en Do" } } } }<br>    \theNotes<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { \line { "Instrument en Si" \smaller \flat }<br>                         \line { "\\transpose c d (1 ton)" } } } }<br>    \transpose c d \theNotes<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { \line { "Instrument en Si" \smaller \flat }<br>                         \line { "\\transpose c eses (1 ton)" } } } }<br>    \transpose c eses \theNotes<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { \line { "Instrument en Mi" \smaller \flat }<br>                         \line { "\\transpose c a (4 tons  ½)" } } } }<br>    \transpose c a \theNotes<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { \line { "Instrument en Mi" \smaller \flat }<br>                         \line { "\\transpose c beses (4 tons  ½)" } } } }<br>    \transpose c beses \theNotes<br>  &gt;&gt;<br>}</pre>
<p>Pour les accords le même problème se pose mais est un petit peu plus compliqué à résoudre en utilisant la propriété chordRootNamer (voir code ci-dessous et <a href="https://lilypond.org/doc/v2.23/Documentation/notation/displaying-chords.fr.html">cette page de documentation</a>) . Ici ce n'est plus l'intervalle de transposition qui varie mais directement la base de l'accord via un double procédé enharmonique. Merci encore Jean.</p>
<figure class="post__image" ><img loading="lazy" src="https://myrealbook.vintherine.org/media/posts/26/document-4.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/26/responsive/document-4-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/26/responsive/document-4-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/26/responsive/document-4-md.png 768w"  alt="" width="583" height="303">
<figcaption >Fm7 c'est plus intuitif que E♯m7 n'est-ce-pas ?</figcaption>
</figure>
<p> </p>
<pre>\version "2.22.1"<br><br>#(use-modules (ice-9 match))<br><br>#(define enharmonization<br>   #((0 . 0) ; C♮<br>             (0 . 1/2) ; D♭ → C ♯<br>             (1 . 0) ; D♮<br>             (2 . -1/2) ; D♯ → E♭<br>             (2 . 0) ; E♮<br>             (3 . 0) ; F♮<br>             (3 . -1/2) ; G♭ → F♯<br>             (4 . 0) ; G♮<br>             #f ; G♯/A♭<br>             (5 . 0) ; A♮<br>             (6 . -1/2) ; A♯ → B♭<br>             (6 . 0) ; B♮<br>             ))<br><br>#(define (enharmonize pitch)<br>   (let* ((semitones (ly:pitch-semitones pitch))<br>          (normalized-semitones (modulo semitones 12))<br>          (eventual-octave (* 1/12 (- semitones normalized-semitones))))<br>     (match (vector-ref enharmonization normalized-semitones)<br>            ((best-name . best-alteration)<br>             (ly:make-pitch eventual-octave best-name best-alteration))<br>            (#f<br>             ;; G♯/A♭<br>             (if (positive? (ly:pitch-alteration pitch))<br>                 (ly:make-pitch eventual-octave 4 1/2)<br>                 (ly:make-pitch eventual-octave 5 -1/2))))))<br><br>%% Tests<br>#(for-each<br>  (match-lambda<br>   ((input output)<br>    (let ((processed (enharmonize input)))<br>      (if (not (equal? output (enharmonize input)))<br>          (ly:error "~s -&gt; ~s: bad output, expected ~s" input processed output)))))<br>  `((,#{ c #} ,#{ c #})<br>    (,#{ cis #} ,#{ cis #})<br>    (,#{ des #} ,#{ cis #})<br>    (,#{ des'' #} ,#{ cis'' #})<br>    (,#{ bisis #} ,#{ cis' #})<br>    (,#{ eeses #} ,#{ d #})<br>    (,#{ gis,, #} ,#{ gis,, #})<br>    (,#{ aes,, #} ,#{ aes,, #})<br>    (,#{ fisis,, #} ,#{ g,, #})))<br><br>\layout {<br>  indent = 4\cm<br>}<br><br>theNotes = { \repeat unfold 6 { R1 } }<br>theChords = \chordmode { gis1:m7 cis:7 fis:7+ g:m7 c:7 f:7+}<br><br>\score {<br>  &lt;&lt;<br>    \new ChordNames \theChords<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { "Instruments"<br>                         \line { "en Do" } } } }<br>    \theNotes<br>  &gt;&gt;<br>}<br><br>\score {<br>  &lt;&lt;<br>    \new ChordNames \transpose c a \theChords<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { \concat { "Pour inst. en Mi" \smaller \flat}<br>                         \line { "sans enharmonisation" } } } }<br>  \theNotes<br>  &gt;&gt;<br>} <br><br>\score {<br>  &lt;&lt;<br>    \new ChordNames \transpose c a \theChords<br>    \new Staff \with { <br>      instrumentName = \markup {<br>        \center-column { \concat { "Pour inst. en Mi" \smaller \flat}<br>                         \line { "avec enharmonisation" } } } } <br>    \theNotes<br>  &gt;&gt;<br>  \layout {<br>    \context {<br>      \ChordNames<br>      chordRootNamer =<br>      #(lambda (pitch lowercase)<br>         (note-name-&gt;markup (enharmonize pitch)<br>                            lowercase))<br>    }<br>  }<br>} </pre>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Fragments alternatifs : utilisation des tags</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/fragments-alternatifs-utilisation-des-tags.html"/>
        <id>https://myrealbook.vintherine.org/fragments-alternatifs-utilisation-des-tags.html</id>

        <updated>2022-01-10T17:42:48+01:00</updated>
            <summary>
                <![CDATA[
                    <p>Dans les répertoires de MyRealBook vous trouverez  des partitions écrites pour instruments en Do, en Si♭ et en Mi♭. Du fait de leur faible tessiture (2,5 octaves) les saxophones me servent de référence pour les instruments transposés.</p>
<p>Les fichiers sources sont d'abord écrits pour instruments en Do, les notes des différentes portées stockées dans des variables,  puis transposées. C'est en principe très simple : \transpose c d  \maMusique pour instruments en Si♭, \transpose c a  (ou a,) pour instruments en Mi♭. Mais il arrive parfois que l'<a href="https://fr.wikipedia.org/wiki/Ambitus">ambitus</a> du morceau soit tel que la partition  transposée soit injouable. </p>
<p>Voici par exemple la première partie de  <em>Zebulon Dance</em> de Didier Lockwood écrit originellement pour violon :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/24/ZebulonDance-CTab.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/24/responsive/ZebulonDance-CTab-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/24/responsive/ZebulonDance-CTab-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/24/responsive/ZebulonDance-CTab-md.png 768w"  alt="Zebulon Dance" width="870" height="284"></figure>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Dans les répertoires de MyRealBook vous trouverez  des partitions écrites pour instruments en Do, en Si♭ et en Mi♭. Du fait de leur faible tessiture (2,5 octaves) les saxophones me servent de référence pour les instruments transposés.</p>
<p>Les fichiers sources sont d'abord écrits pour instruments en Do, les notes des différentes portées stockées dans des variables,  puis transposées. C'est en principe très simple : \transpose c d  \maMusique pour instruments en Si♭, \transpose c a  (ou a,) pour instruments en Mi♭. Mais il arrive parfois que l'<a href="https://fr.wikipedia.org/wiki/Ambitus">ambitus</a> du morceau soit tel que la partition  transposée soit injouable. </p>
<p>Voici par exemple la première partie de  <em>Zebulon Dance</em> de Didier Lockwood écrit originellement pour violon :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/24/ZebulonDance-CTab.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/24/responsive/ZebulonDance-CTab-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/24/responsive/ZebulonDance-CTab-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/24/responsive/ZebulonDance-CTab-md.png 768w"  alt="Zebulon Dance" width="870" height="284"></figure>

<p>L'ambitus couvre un peu de deux octaves, du La3 au Si5. <span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">L'ambitus transposé pour un instrument en Si♭ (Si4 - Do♯6) sera compatible avec un saxophone soprano ou joué une octave en dessous par un saxophone ténor.</span></p>
<p>Tentons maintenant de transposer pour un saxophone alto :</p>
<ol>
<li>avec \transpose c a l'ambitus sera Fa♯3 - Sol♯5 : trop bas 😣</li>
<li>avec \transpose c a' l'ambitus sera Fa♯4 - Sol♯6 : trop haut 😣</li>
</ol>
<p>La solution la plus évidente est de monter d'une octave les seules notes posant problème (entourées de rouge ci-dessus). Pour éviter la solution "<em>bestiale</em>" consistant à dupliquer toute la portée pour ne changer que 7 notes on peut isoler les fragments alternatifs en utilisant des balises (tags). <a href="https://lilypond.org/doc/v2.22/Documentation/notation/different-editions-from-one-source#using-tags">La documentation est ici</a>. </p>
<p>Cette solution est d'autant plus facile dans notre cas qu'il suffit de changer l’octave des fragments en question dans la commande \relative. Exemple de code pour les 3  mesures de la 1ère alternative</p>
<pre>maMusique = \relative c''<br>{<br>  \key a \major cis4  a8  e  b' cis4  a8 ~ | a4  <br>  &lt;&lt; <br>    \tag violon \relative b { b8  cis  a2  } <br>    \tag alto \relative b' { b8  cis  a2  }<br>  &gt;&gt;<br>  r2 r8  e  a  cis \bar ":|."<br>}<br><br>&lt;&lt;  \new Staff \with { instrumentName = "violon" } \keepWithTag violon \maMusique<br>    \new Staff \with { instrumentName = "alto sax" } \keepWithTag alto \transpose c a, \maMusique <br>&gt;&gt;</pre>
<p>Le résultat :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/24/LilyBalises.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/24/responsive/LilyBalises-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/24/responsive/LilyBalises-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/24/responsive/LilyBalises-md.png 768w"  alt="Lily balise" width="540" height="143"></figure>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Lilypond et la pagination</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/lilypond-et-la-pagination.html"/>
        <id>https://myrealbook.vintherine.org/lilypond-et-la-pagination.html</id>

        <updated>2022-01-04T11:12:10+01:00</updated>
            <summary>
                <![CDATA[
                    <p>À priori Lilypond permet de gérer finement la plupart des problèmes de pagination grâce à des variables dans les blocs <samp>\paper {}</samp></p>
<ul>
<li>afficher les numéros de pages (<samp>print-page-number = ##t</samp>, oui par défaut) ou non (<samp>##f</samp>)</li>
<li>afficher le numéro de la première page (<samp>print-first page-number = ##f</samp>, non par défaut)</li>
<li>afficher les numéros en chiffres arabes (<samp>page-number-type = 'arabic</samp>,  par défaut),  romains minuscules ( <samp>'roman-lower</samp>) ou romains majuscules ( <samp>'roman-upper</samp>)</li>
<li>Changer le numéro de la première page avec <samp>first-page-number</samp>. La valeur par défaut est de <samp>#1</samp>.</li>
</ul>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>À priori Lilypond permet de gérer finement la plupart des problèmes de pagination grâce à des variables dans les blocs <samp>\paper {}</samp></p>
<ul>
<li>afficher les numéros de pages (<samp>print-page-number = ##t</samp>, oui par défaut) ou non (<samp>##f</samp>)</li>
<li>afficher le numéro de la première page (<samp>print-first page-number = ##f</samp>, non par défaut)</li>
<li>afficher les numéros en chiffres arabes (<samp>page-number-type = 'arabic</samp>,  par défaut),  romains minuscules ( <samp>'roman-lower</samp>) ou romains majuscules ( <samp>'roman-upper</samp>)</li>
<li>Changer le numéro de la première page avec <samp>first-page-number</samp>. La valeur par défaut est de <samp>#1</samp>.</li>
</ul>

<p>Une chose pourtant fait défaut malgré des demandes répétées depuis de longues années : ce paramétrage ne fonctionne qu'au niveau du bloc <samp>\book</samp> et reste sans effet au niveau du bloc <samp>\bookpart</samp>. Voici au moins deux exemples pour lesquels cette limitation pose problème :</p>
<ul>
<li>Au début d'un ouvrage une préface ou une table des matière sera couramment numérotée en chiffres romains, la suite recommençant à 1 en chiffres arabes.</li>
<li>Pour des partitions pour orchestre on aimerait que directeur et parties soient regroupées dans un même ouvrage mais que la numérotation de chaque partie débute à 1.</li>
</ul>
<p>Il existe heureusement une solution de contournement que l'on doit initialement à Thomas Morley (voir <a href="https://www.mail-archive.com/lilypond-user@gnu.org/msg115188.html">cette page des archives de la liste anglophone des utilisateurs de Lilypond</a>) et récemment corrigée par Valentin Petzel sur la même liste.</p>
<p>Une remarque concernant l'exemple fourni avec le code repose sur la version 2.19 de Lilypond qu'il faut mettre à jour avec convert-ly (modifications de <samp>\tocItem</samp>  qui nécessite un <samp>\markup</samp>)</p>
<p>Pour utiliser cette solution copiez tout d'abord dans votre code la fonction ci-dessous (à la fin de cet article) ou collez-la dans un fichier à inclure et insérez un bloc <samp>\paper {}</samp> à l'intérieur  des <samp>\bookpart</samp> avec les variables suivantes :</p>
<ul>
<li><samp>oddHeaderMarkup = \oddMarkup #'arabic</samp></li>
<li><samp>evenHeaderMarkup = \evenMarkup #'arabic</samp></li>
</ul>
<p>arabic peut être remplacé par roman-lower ou roman-upper</p>
<p>La variable <samp>print-first page-number</samp> est maintenant par défaut à <samp>##t</samp> mais peut être modifiée dans ce même bloc</p>
<p>Un exemple :</p>
<pre><code>\version "2.22.1"</code><br><code>\include "BookPartPagesNumber.ly"</code><br><br><code>musique = \relative c'' { \repeat unfold 2 { d1 \pageBreak } }</code><br><br><code>\book {</code><br><code>  \bookpart {</code><br><code>    \paper {</code><br><code>      oddHeaderMarkup = \oddMarkup #'roman-lower</code><br><code>      evenHeaderMarkup = \evenMarkup #'roman-lower</code><br><code>    }</code><br><code>    \score {</code><br><code>      \musique</code><br><code>    }</code><br><code>  }</code><br><code>  \bookpart {</code><br><code>    \paper {</code><br><code>      print-first-page-number = ##f</code><br><code>      oddHeaderMarkup = \oddMarkup #'arabic</code><br><code>      evenHeaderMarkup = \evenMarkup #'arabic</code><br><code>    }</code><br><code>    \score {</code><br><code>      \musique</code><br><code>    }</code><br><code>        \score {</code><br><code>      \musique</code><br><code>    }</code><br><code>  }</code><br><code>}</code></pre>
<p>La fonction BookPartPagesNumber</p>
<pre>\<code>version "2.22.1"</code><br><br><code>#(define part-first-pages '(0))</code><br><br><code>#(define (part-first-page? layout props)</code><br><code>  (= (chain-assoc-get 'page:page-number props -1)</code><br><code>     (ly:output-def-lookup layout 'first-page-number)))</code><br><br><code>#(define (reset-part-first-page layout props arg)</code><br><code>"Returns page-number-string, starting every bookpart with page-number 0.</code><br><code>Relying on the extern defined `part-first-pages'.</code><br><code>"</code><br><code>  (set! props (prepend-alist-chain 'part-first-page '(0) props))</code><br><br><code>  (let* ((real-page-number (chain-assoc-get 'page:page-number props -1))</code><br><code>         (parts-page-number (- real-page-number (car part-first-pages))))</code><br><br><code>    (if (part-first-page? layout props)</code><br><code>        (set! part-first-pages (cons (1- real-page-number) part-first-pages)))</code><br><br><code>    (set! props</code><br><code>      (cons</code><br><code>        (list</code><br><code>          (cons 'page:page-number-string (number-&gt;string parts-page-number))</code><br><code>          (cons 'page:page-number parts-page-number))</code><br><code>        props))</code><br><code>    (interpret-markup layout props arg)))</code><br><br><code>#(define ((print-part-first-page-as-one number-type) layout props arg)</code><br><br><code>  (set! props</code><br><code>    (cons</code><br><code>      (list</code><br><code>        (cons 'page:page-number-string</code><br><code>              (let ((page-number</code><br><code>                     (chain-assoc-get 'page:page-number props -1)))</code><br><code>                ;(if (&lt;= page-number 0) ""</code><br><code>                (cond ((and (eq? number-type 'roman-lower) (&gt; page-number 0))</code><br><code>                       (fancy-format #f "~(~@r~)" page-number))</code><br><code>                      ((and (eq? number-type 'roman-upper) (&gt; page-number 0))</code><br><code>                       (fancy-format #f "~@r" page-number))</code><br><code>                          ((eq? number-type 'arabic)</code><br><code>                           (number-&gt;string page-number))</code><br><code>                          (else (number-&gt;string page-number)))));)</code><br><code>        (cons 'page:page-number</code><br><code>              (chain-assoc-get 'page:page-number props -1)))</code><br><code>      props))</code><br><code>  (interpret-markup layout props arg))</code><br><br><code>\paper {</code><br><code>  print-first-page-number = ##t</code><br><code>  oddMarkup =</code><br><code>  #(define-scheme-function (number-type)(symbol?)</code><br><code>    #{</code><br><code>      \markup</code><br><code>        \column {</code><br><code>          \fill-line {</code><br><code>            " "</code><br><code>            \on-the-fly #not-part-first-page \fromproperty #'header:instrument</code><br><code>              %% use in this order:</code><br><code>              \on-the-fly #reset-part-first-page</code><br><code>              \on-the-fly #(print-part-first-page-as-one number-type)</code><br><code>              \on-the-fly #print-page-number-check-first</code><br><code>              \fromproperty #'page:page-number-string</code><br><code>          }</code><br><code>        }</code><br><code>    #})</code><br><br><code>  evenMarkup =</code><br><code>  #(define-scheme-function (number-type)(symbol?)</code><br><code>    #{</code><br><code>      \markup</code><br><code>        \column {</code><br><code>          \fill-line {</code><br><code>              %% use in this order:</code><br><code>              \on-the-fly #reset-part-first-page</code><br><code>              \on-the-fly #(print-part-first-page-as-one number-type)</code><br><code>              \on-the-fly #print-page-number-check-first</code><br><code>              \fromproperty #'page:page-number-string</code><br><code>            \on-the-fly #not-part-first-page \fromproperty #'header:instrument</code><br><code>            " "</code><br><code>          }</code><br><code>        }</code><br><code>    #})</code><br><code>}</code></pre>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>MyRealBook : les partitions</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/myrealbook-les-partitions.html"/>
        <id>https://myrealbook.vintherine.org/myrealbook-les-partitions.html</id>

        <updated>2022-03-19T10:46:48+01:00</updated>
            <summary>
                <![CDATA[
                     Le tableau dynamique à tri multicritère [inadapté à un ordiphone] Par&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <ul>
<li><a href="scores/index.html">Le tableau dynamique à tri multicritère</a> [inadapté à un ordiphone]</li>
<li><a href="scores/ByAlpha.html">Par ordre alphabétique des titres</a></li>
<li><a href="scores/ByComposers.html">Par ordre des compositeurs</a></li>
<li><a href="scores/ByStyles.html">Par styles (swing, bop, salsa etc.)</a></li>
<li><a href="scores/ByTempi.html">Par tempi (slow, medium, fast etc.)</a></li>
<li><a href="scores/Combos.html">Partitions pour combos ou petits big bands</a></li>
<li><a href="scores/Lyrics.html">Partitions contenant des paroles</a></li>
<li><a href="scores/Latest.html">Les 10 partitions les plus récentes</a></li>
</ul>
<p>Un petit rappel : MyRealBook est un site statique. Cela présente de nombreux avantages (rapidité, sobriété...) mais le revers de la médaille est l'impossibilité de proposer des pages personnalisées. Ce qui constitue indéniablement une limitation en matière de navigation et de recherche (*). Pour tenter d'y remédier voici ci-dessus plusieurs moyens d’accéder aux centaines de partitions que contient ce site.</p>
<p>(*) Il vous est toujours possible d'utiliser le module de recherche de votre navigateur au sein d'une même page.</p>
<h4><a href="scores/index.html">À propos du tableau dynamique à tri multicritère</a></h4>
<p>C'est sans doute la manière la plus <span class="tlf_csyntagme"><i>efficiente</i> de trouver ce que l'on recherche : il est possible de trier par titres (par défaut), par compositeurs, par styles, par tempi, par interprètes et / ou par présences ou non des paroles. Plusieurs tri successifs sont possibles.</span></p>
<p class="msg msg--highlight ">Mode d'emploi : Les flèches dans les en-têtes de colonnes permettent d'activer / désactiver le tri du tableau. Un chiffre est ajouté à droite du titre pour indiquer l'ordre du tri, une flèche rouge indique la direction du tri.</p>
<p>Principal défaut de ce tableau : il n'est pas "<em>Responsive design</em>", c'est à dire qu'il ne se redimensionne pas en fonction des tailles d'écran. Il n'est donc pas adapté à un ordiphone.</p>
<h4><a href="https://github.com/vgay/vgay.github.io">Cloner GitHub</a></h4>
<p>Ce site est sur GitHub, clonez-le avec toutes ses partitions ou téléchargez le .zip (cliquez sur le bouton vert "Code" puis sur le lien "Download ZIP")</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Un peu de couleur</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/un-peu-de-couleur.html"/>
        <id>https://myrealbook.vintherine.org/un-peu-de-couleur.html</id>

        <updated>2021-12-24T17:16:18+01:00</updated>
            <summary>
                <![CDATA[
                    <p>À la lecture d'une grille harmonique un jazzman chevronné sait immédiatement ce que recouvre chaque accord et quelles gammes et arpèges il peut jouer. Un débutant devra au contraire étudier longuement sa partition, repérer les notes fortes, l'annoter et répéter inlassablement les enchaînements caractéristiques tels les II-V-I , les cadences plagale (IV-I), les marches harmoniques...</p>
<p>Lorsque j'étais moi-même débutant j'utilisais mes crayons de couleur pour repérer plus visuellement les tonalités, une peu comme ceci :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/21/LesPassantes.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/21/responsive/LesPassantes-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/21/responsive/LesPassantes-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/21/responsive/LesPassantes-md.png 768w"  alt="Les Passantes de Georges Brassens" width="793" height="391"></figure>
<p>Voyons comment faire ceci avec Lilypond.</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>À la lecture d'une grille harmonique un jazzman chevronné sait immédiatement ce que recouvre chaque accord et quelles gammes et arpèges il peut jouer. Un débutant devra au contraire étudier longuement sa partition, repérer les notes fortes, l'annoter et répéter inlassablement les enchaînements caractéristiques tels les II-V-I , les cadences plagale (IV-I), les marches harmoniques...</p>
<p>Lorsque j'étais moi-même débutant j'utilisais mes crayons de couleur pour repérer plus visuellement les tonalités, une peu comme ceci :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/21/LesPassantes.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/21/responsive/LesPassantes-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/21/responsive/LesPassantes-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/21/responsive/LesPassantes-md.png 768w"  alt="Les Passantes de Georges Brassens" width="793" height="391"></figure>
<p>Voyons comment faire ceci avec Lilypond.</p>

<p>Commençons par écrire une partitions ordinaire avec une ou deux voix. Dans l'exemple ci-dessus j'utilise les notes fortes des accords (généralement tierces et septièmes) en guise de guide-ton. Dans chaque mesure j'indique par un changement de clef la tonalité induite par les accords.</p>
<p>Le style Realbook est utilisé comme à l'habitude mais n'est pas indispensable. Voir les posts  <a href="https://myrealbook.vintherine.org/a-propos-des-logiciels-deditions-utilises.html">À propos des logiciels</a>, (partie Lilyjazz) et <a href="https://myrealbook.vintherine.org/titres-a-la-realbook.html">Titres à la Realbook.</a></p>
<p>Pour avoir une barre de reprise avant la première mesure je triche par un \partial 256 s256 (penser à mettre ce s256 également avant les noms d'accords). Cela permet aussi d'indiquer la tonalité initiale à l'intérieur la première mesure. Pour éviter que ce silence ne prenne trop de place au début de la ligne  il est nécessaire d'indiquer à Lilypond d'écrire de façon proportionnelle par le code suivant :</p>
<pre><code>\layout { </code><br><code>  \context { </code><br><code>    \Score </code><br><code>    proportionalNotationDuration = #(ly:make-moment 1/10) </code><br><code>} }</code></pre>
<p>Venons-en maintenant au coloriage des mesures. Elle est possible grâce à la fonction staffColor écrite par Jean Abou Samra et postée dans la liste de discussion des utilisateurs francophones de lilypond. </p>
<pre><code>\version "2.22.1"</code><br><br><code>#(define (define-grob! grob-name grob-entry)</code><br><code>   (set! all-grob-descriptions</code><br><code>         (cons ((@@ (lily) completize-grob-entry)</code><br><code>                (cons grob-name grob-entry))</code><br><code>               all-grob-descriptions)))</code><br><br><code>#(define (staff-colorizer::print grob)</code><br><code>   (let* ((staff-symbol (ly:grob-object grob 'staff-symbol))</code><br><code>          (left (ly:spanner-bound grob LEFT))</code><br><code>          (right (ly:spanner-bound grob RIGHT))</code><br><code>          (refp (ly:grob-system grob))</code><br><code>          (spacing-pair (ly:grob-property grob 'spacing-pair))</code><br><code>          (coord-adjust (ly:grob-relative-coordinate grob refp X))</code><br><code>          (x-span (cons (- (interval-end (ly:paper-column::break-align-width</code><br><code>                                          left</code><br><code>                                          (car spacing-pair)))</code><br><code>                           coord-adjust)</code><br><code>                        (- (interval-start (ly:paper-column::break-align-width</code><br><code>                                            right</code><br><code>                                            (cdr spacing-pair)))</code><br><code>                           coord-adjust)))</code><br><code>          (y-span (ly:grob-extent staff-symbol staff-symbol Y)))</code><br><code>     (make-filled-box-stencil x-span y-span)))</code><br><br><code>#(define-grob!</code><br><code>   'StaffColorizer</code><br><code>   `((stencil . ,staff-colorizer::print)</code><br><code>     (layer . -1)</code><br><code>     (spacing-pair . (staff-bar . staff-bar))</code><br><code>     (meta . ((class . Spanner)</code><br><code>              (interfaces . (text-interface))))))</code><br><br><code>#(set-object-property! 'staffColor 'translation-type? color?)</code><br><br><code>#(define (Staff_colorizer_engraver context)</code><br><code>   (let ((current-color #f)</code><br><code>         (spanner #f))</code><br><code>     (make-engraver</code><br><code>       ((process-music engraver)</code><br><code>          (let ((color (ly:context-property context 'staffColor #f)))</code><br><code>            (if (and color</code><br><code>                     (not (equal? color current-color)))</code><br><code>                (let ((column (ly:context-property context 'currentCommandColumn)))</code><br><code>                  (set! current-color color)</code><br><code>                  (if spanner</code><br><code>                      (ly:spanner-set-bound! spanner RIGHT column))</code><br><code>                  (set! spanner (ly:engraver-make-grob engraver 'StaffColorizer '()))</code><br><code>                  (ly:grob-set-property! spanner 'color current-color)</code><br><code>                  (ly:spanner-set-bound! spanner LEFT column)))))</code><br><code>       ((finalize engraver)</code><br><code>          (if spanner</code><br><code>              (let ((column (ly:context-property context 'currentCommandColumn)))</code><br><code>                (ly:spanner-set-bound! spanner RIGHT column)))))))</code><br><br><code>\layout {</code><br><code>  \context {</code><br><code>    \Global</code><br><code>    \grobdescriptions #all-grob-descriptions</code><br><code>  }</code><br><code>  \context {</code><br><code>    \Staff</code><br><code>    \consists #Staff_colorizer_engraver</code><br><code>  }</code><br><code>}</code><br><br><code>staffColor = \set Staff.staffColor = \etc </code></pre>
<p>j'ai enregistré ce code dans un fichier staffColor.ly que j'appelle dans mes \include</p>
<p>Le code complet :</p>
<pre><code>\version "2.22.1"</code><br><code>#(set-global-staff-size 18)</code><br><code>\include "jazzchords.ily"</code><br><code>\include "lilyjazz.ily"</code><br><code>\include "staffColor.ly"</code><br><br><code>\paper {</code><br><code>  indent = 0\mm</code><br><code>  ragged-last-bottom = ##t</code><br><code>  ragged-bottom = ##f</code><br><code>  ragged-last = ##f</code><br><code>  markup-system-spacing = #'((basic-distance . 23)</code><br><code>                             (minimum-distance . 8)</code><br><code>                             (padding . 1))</code><br><code>}</code><br><br><code>title = #"Les passantes"</code><br><code>composer = #"Georges Brassens"</code><br><code>meter = #"(Ballad)"</code><br><br><code>realBookTitle = \markup {</code><br><code>  \score {</code><br><code>    {</code><br><code>      \override TextScript.extra-offset = #'(0 . -4.5)</code><br><code>      s4</code><br><code>      s^\markup {</code><br><code>        \fill-line {</code><br><code>          \fontsize #1 \lower #1 \rotate #7 \concat { " " #meter }</code><br><code>          \fontsize #4</code><br><code>          \override #'(offset . 9)</code><br><code>          \override #'(thickness . 6)</code><br><code>          \underline \larger \larger #title</code><br><code>          \fontsize #1 \lower #1 \concat { #composer " " }</code><br><code>        }</code><br><code>      }</code><br><code>      s</code><br><code>    }</code><br><code>    \layout {</code><br><code>      \omit Staff.Clef</code><br><code>      \omit Staff.TimeSignature</code><br><code>      \omit Staff.KeySignature</code><br><code>      ragged-right = ##f</code><br><code>    }</code><br><code>  }</code><br><code>}</code><br><br><code>voltaAdLib = \markup { 1. 2. 3… \italic \text "ad lib." }</code><br><code>voltaOnCue = \markup \small \text "Last X"</code><br><br><code>\header {</code><br><code>  pdftitle = #title</code><br><code>  pdfauthor = #composer</code><br><code>  title = \realBookTitle</code><br><code>  tagline = ##f</code><br><code>}</code><br><br><code>\layout {</code><br><code>  \context {</code><br><code>    \Score</code><br><code>    proportionalNotationDuration = #(ly:make-moment 1/10)</code><br><code>    \omit BarNumber</code><br><code>    startRepeatType = #"[|:"</code><br><code>    endRepeatType = #":|]"</code><br><code>    doubleRepeatType = #":|][|:"</code><br><code>    \override Clef #'break-visibility = #'#(#f #f #f)</code><br><code>    \override KeySignature #'break-visibility = #'#(#f #t #t)</code><br><code>    \override SystemStartBar #'collapse-height = #1</code><br><code>  }</code><br><code>  \context { </code><br><code>    \Staff</code><br><code>    printPartCombineTexts = ##f</code><br><code>    \consists "Merge_rests_engraver"</code><br><code>  }</code><br><code>  \context {</code><br><code>    \ChordNames</code><br><code>    \override ParenthesesItem.font-size = #2</code><br><code>  }</code><br><code>  \context { \Score markFormatter = #format-mark-box-alphabet }</code><br><code>}</code><br><br><br><code>accords = \chordmode {</code><br><code>  \set chordChanges = ##t</code><br><code>  s512</code><br><code>  f1:7+ e:7 a:7 d:7 d:m7 g:7 c:7+ e:7 </code><br><code>  f1:7+ e:7 a:7 d:7 a:m7 g:7 a:m7 g2:m7 c:7 a1:m </code><br><code>}</code><br><br><code>theNotes =  \relative c''' {</code><br><code>  \clef "treble" \time 4/4</code><br><code>  \partial 512 s512</code><br><code>  %\showStartBar \bar "[|:"</code><br><code>  \set Staff.explicitKeySignatureVisibility = ##(#f #t #t)</code><br><code>  \override Staff.KeyCancellation.break-visibility = #all-invisible </code><br><br><code>  \repeat volta 2</code><br><code>  {</code><br><code>    &lt;&lt; </code><br><code>      { \key f \major \staffColor aqua a1 </code><br><code>        \key a \major \staffColor pink  gis </code><br><code>        \key d \major \staffColor orange g! </code><br><code>        \key g \major \staffColor yellow fis \break </code><br><code>        \key c \major \staffColor Chartreuse f! f e </code><br><code>        \key a \major \staffColor pink d \break</code><br><code>        \key f \major \staffColor aqua e </code><br><code>        \key a \major \staffColor pink d </code><br><code>        \key d \major \staffColor orange cis </code><br><code>        \key g \major \staffColor yellow c! \break </code><br><code>        \once \override Staff.KeyCancellation.break-visibility = ##(#f #t #t)</code><br><code>        \key c \major \staffColor Chartreuse c b c  } </code><br><code>      \\ </code><br><code>      { e d cis c </code><br><code>        c b b gis</code><br><code>        a gis g! fis</code><br><code>        g f c </code><br><code>      } </code><br><code>    &gt;&gt;</code><br><code>  }</code><br><code>  \alternative {</code><br><code>    { </code><br><code>      \overrideProperty Score.VoltaBracket.text \voltaAdLib</code><br><code>      &lt;&lt; { \key f \major \staffColor aqua bes' } \\ { f2 e } &gt;&gt; }</code><br><code>    { </code><br><code>      \overrideProperty Score.VoltaBracket.text \voltaOnCue</code><br><code>      &lt;&lt; { \key c \major \staffColor Chartreuse c'1 } \\ { e,1 } &gt;&gt; \bar ".." }</code><br><code>  }</code><br><code>}</code><br><br><code>    \score {</code><br><code>      &lt;&lt;</code><br><code>        \new ChordNames { \accords }</code><br><code>        \new Staff \theNotes</code><br><code>      &gt;&gt;</code><br><code>} </code></pre>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Mesures composées</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/mesures-composees.html"/>
        <id>https://myrealbook.vintherine.org/mesures-composees.html</id>

        <updated>2021-12-04T12:14:33+01:00</updated>
            <summary>
                <![CDATA[
                    <p>J'ai travaillé récemment sur des morceaux à la métrique un peu inhabituelle : Her Song de Daniel Goyone, écrit en 13/8, et le très beau thème de Zem Audu, <a href="https://zemaudu.bandcamp.com/album/visions">Vision</a>, écrit en 11/8. Dans un cas comme dans l'autre il s'agit de mesures composées complexes :</p>
<ul>
<li>5/8+5/8+3/8 pour le premier</li>
<li>4/8+4/8+3/8 pour le second</li>
</ul>
<p>Évidemment  il faudra indiquer aux musiciens la nature de cette composition et à Lilypond comment disposer les ligatures des croches.</p>
<p>À peine évoquée cette question sur la liste de discussion Lilypond je reçoit une réponse sous la forme d'une fonction due  à l'inévitable Jean Abou Samra :</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>J'ai travaillé récemment sur des morceaux à la métrique un peu inhabituelle : Her Song de Daniel Goyone, écrit en 13/8, et le très beau thème de Zem Audu, <a href="https://zemaudu.bandcamp.com/album/visions">Vision</a>, écrit en 11/8. Dans un cas comme dans l'autre il s'agit de mesures composées complexes :</p>
<ul>
<li>5/8+5/8+3/8 pour le premier</li>
<li>4/8+4/8+3/8 pour le second</li>
</ul>
<p>Évidemment  il faudra indiquer aux musiciens la nature de cette composition et à Lilypond comment disposer les ligatures des croches.</p>
<p>À peine évoquée cette question sur la liste de discussion Lilypond je reçoit une réponse sous la forme d'une fonction due  à l'inévitable Jean Abou Samra :</p>

<pre><code>#(set-object-property! 'inter-time-signature-padding 'backend-type? number?)</code><br><code>#(set-object-property! 'angularity 'backend-type? number?)</code><br><br><code>twoCompoundMeters =</code><br><code>#(define-music-function (args args2) (pair? pair?)</code><br><code>   (let* ((mlen (calculate-compound-measure-length args))</code><br><code>          (beat (calculate-compound-base-beat args))</code><br><code>          (beatGrouping (calculate-compound-beat-grouping args))</code><br><code>          (timesig (cons (ly:moment-main-numerator mlen)</code><br><code>                         (ly:moment-main-denominator mlen))))</code><br><code>     #{</code><br><code>       \once \override Timing.TimeSignature.stencil =</code><br><code>       #(lambda (grob)</code><br><code>          (grob-interpret-markup grob</code><br><code>                                 (make-concat-markup</code><br><code>                                  (list</code><br><code>                                   (make-compound-meter-markup args)</code><br><code>                                   (make-hspace-markup</code><br><code>                                    (ly:grob-property grob 'inter-time-signature-padding 0))</code><br><code>                                   (make-parenthesize-markup</code><br><code>                                    (make-compound-meter-markup args2))))))</code><br><code>       \set Timing.timeSignatureFraction = #timesig</code><br><code>       \set Timing.baseMoment = #beat</code><br><code>       \set Timing.beatStructure = #beatGrouping</code><br><code>       \set Timing.beamExceptions = #'()</code><br><code>       \set Timing.measureLength = #mlen</code><br><code>     #}))</code><br><br><code>\layout {</code><br><code>  % Valeurs utiles à ajuster</code><br><code>  \override Staff.TimeSignature.inter-time-signature-padding = 1.3</code><br><code>  \override Staff.TimeSignature.thickness = 1</code><br><code>  \override Staff.TimeSignature.width = 0.25</code><br><code>  \override Staff.TimeSignature.angularity = 0</code><br><code>}</code></pre>
<p>une fois collée cette fonction dans votre code (avant la musique) il suffira de remplacer par exemple :</p>
<pre><code>\time 11/8</code></pre>
<p>par</p>
<pre><code>\twoCompoundMeters #'((4 8) (4 8) (3 8)) #'(11 8)</code></pre>
<p>le résultat : </p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/20/Vision-2.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/20/responsive/Vision-2-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/20/responsive/Vision-2-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/20/responsive/Vision-2-md.png 768w"  alt="" width="879" height="201"></figure>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Liens dans la partitions</title>
        <author>
            <name>Vincent</name>
        </author>
        <link href="https://myrealbook.vintherine.org/liens-dans-la-partitions.html"/>
        <id>https://myrealbook.vintherine.org/liens-dans-la-partitions.html</id>

        <updated>2021-11-22T10:07:30+01:00</updated>
            <summary>
                <![CDATA[
                    <p>Depuis qu'on affiche sur des tablettes plutôt que de les imprimer les partitions sont devenues interactives. Avec Lilypond 3 instructions nous permettent d'en profiter pleinement.</p>
<h5>I - with-url, une ouverture sur le web</h5>
<p>Pour aller télécharger des partitions ou pour regarder une vidéo, il suffit d'associer un markup avec une adresse web. Sous le titre des partitions proposées sur ce site  apparaissent quelquefois des liens vers une interprétation de référence. Par exemple :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/19//BreakfastWine.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/19//responsive/BreakfastWine-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/19//responsive/BreakfastWine-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/19//responsive/BreakfastWine-md.png 768w"  alt="Breakfast Wine" width="790" height="198"></figure>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Depuis qu'on affiche sur des tablettes plutôt que de les imprimer les partitions sont devenues interactives. Avec Lilypond 3 instructions nous permettent d'en profiter pleinement.</p>
<h5>I - with-url, une ouverture sur le web</h5>
<p>Pour aller télécharger des partitions ou pour regarder une vidéo, il suffit d'associer un markup avec une adresse web. Sous le titre des partitions proposées sur ce site  apparaissent quelquefois des liens vers une interprétation de référence. Par exemple :</p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/19//BreakfastWine.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/19//responsive/BreakfastWine-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/19//responsive/BreakfastWine-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/19//responsive/BreakfastWine-md.png 768w"  alt="Breakfast Wine" width="790" height="198"></figure>

<p>Le code :</p>
<pre><code>\header {</code><br><code>  title = "Breakfast Wine"</code><br><code>  asplayed = #"Bobby Shew" % doit être commentée si vide</code><br><code>  url = #"https://www.youtube.com/watch?v=sNlNoqxGOLo"</code><br><code>  arranger = \markup </code><br><code>  \with-url #url</code><br><code>  \with-color #blue \underline</code><br><code>  \concat { "(as played by " \fromproperty #'header:asplayed ")" }</code><br><code>  }</code></pre>
<p>N.B. voir <a href="https://myrealbook.vintherine.org/titres-a-la-realbook.html">cet article</a> au sujet des présentations "à la Realbook"  </p>
<h5>II - page-link pour faire de belles pages de garde</h5>
<p>Si une partition contient plusieurs parties une jolie page d'accueil permettant d'accéder à chacune d'entre elles d'un simple clic sera bien plus ergonomique que de tourner des pages. </p>
<p>page-link s'emploie dans un markup avec comme paramètre un simple numéro de page. </p>
<pre><code>\markup { \page-link #3 { Texte du lien vers la page 3 } }</code></pre>
<p>voici un exemple tiré d'un recueil de partitions pour big band. Chaque nom d'instrument dans la liste est un lien amenant à la bonne page. </p>
<figure class="post__image"><img loading="lazy"  src="https://myrealbook.vintherine.org/media/posts/19/Cambios.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://myrealbook.vintherine.org/media/posts/19/responsive/Cambios-xs.png 300w ,https://myrealbook.vintherine.org/media/posts/19/responsive/Cambios-sm.png 480w ,https://myrealbook.vintherine.org/media/posts/19/responsive/Cambios-md.png 768w"  alt="" width="909" height="562"></figure>
<p> </p>
<p>la partie du code concernée :</p>
<pre>    <code>\markup {</code><br><code>      \column {      </code><br><code>        \vspace #3</code><br><code>        \fill-line { \fontsize #9 "Cambios" }</code><br><code>        \fill-line { "Music for Little Big Band" }</code><br><code>        \vspace #6      </code><br><code>        \fontsize #4 {</code><br><code>          \page-link #2 \line  {  \hspace #10 \underline { Horn I \fontsize #-2 "(Alto Sax)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #6 \line  {  \hspace #10 \underline { Horn II \fontsize #-2 "(Tenor Sax)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #10 \line  {  \hspace #10 \underline { Horn III \fontsize #-2 "(Baryton Sax)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #14 \line  {  \hspace #10 \underline { Horn IV \fontsize #-2 "(Trumpet 1)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #18 \line  {  \hspace #10 \underline { Horn V \fontsize #-2 "(Trumpet 2)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #22 \line  {  \hspace #10 \underline { Horn VI \fontsize #-2 "(Trombone)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #26 \line  {  \hspace #10 \underline { Piano \fontsize #-2 "(or Guitare)" } }</code><br><code>          \vspace #0.3</code><br><code>          \page-link #30 \line  {  \hspace #10 \underline { Bass } }</code><br><code>        }</code><br><code>        \vspace #1</code><br><code>        \override #'(line-width . 120)</code><br><code>        \fontsize #2 \fill-line { " " "Lilypond sources embeded in pdf file" }</code><br><code>      }</code><br><code>    }</code></pre>
<h5>III - with-link pour se déplacer aisément dans la partition</h5>
<p>La surface utile d'une tablette ordinaire étant tout juste équivalente à la moitié d'une feuille a4 on est amené à tourner les pages beaucoup plus fréquemment. Bien sûr cela peut se faire au pied avec un tourne-page bluetooth ou usb, mais quand il faut remonter 4 pages après un D.C. al Coda puis les redescendre aussitôt pour atteindre la susdite coda cela devient fastidieux. La solution ? Cliquer sur les liens que constituent les textes D.C. ou To Coda.</p>
<p>Cette technique s'apparente donc au page-link du chapitre précédent à ceci près qu'au lieu de donner un numéro de page en paramètre on fera référence à une étiquette préalablement établie.</p>
<p>Par exemple :</p>
<pre>% une étiquette au Segno<br>\label #'Segno<br>\mark \markup \bold { \box { A } \musicglyph "scripts.varsegno"  }<br><br>% puis plus tard<br>\mark \markup { \with-link #'Segno {  D.S. al Coda } }</pre>
            ]]>
        </content>
    </entry>
</feed>
